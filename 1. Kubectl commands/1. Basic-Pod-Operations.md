# Basic Pod Operations

## What are Pods?

**Pods** are the smallest and most basic deployable units in Kubernetes. Think of them as the "wrapper" around your application containers.

### üè† **Simple Analogy:**
A Pod is like a **shared apartment** where:
- **1 or more containers** live together (usually just 1)
- They share the same **IP address** (like a home address)
- They share **storage volumes** (like shared closets)
- They live and die together (if the apartment goes down, everyone goes down)

### üì¶ **What's Inside a Pod:**
- **Main Container**: Your application (e.g., nginx, your web app)
- **Sidecar Containers** (optional): Helper containers (logging, monitoring)
- **Shared Network**: All containers use the same IP address
- **Shared Storage**: Volumes that containers can access
- **Pod Lifecycle**: They start, run, and terminate together

### üîÑ **Pod Characteristics:**
- **Ephemeral**: Pods can be created, destroyed, and recreated
- **Unique IP**: Each pod gets its own IP address within the cluster
- **Shared Localhost**: Containers in same pod can talk via `localhost`
- **Single Node**: All containers in a pod run on the same worker node

### üí° **Key Differences:**
| Containers | Pods |
|------------|------|
| Individual processes | Group of related containers |
| Have their own network | Share network and storage |
| Docker/containerd manages them | Kubernetes manages them |
| No scheduling | Kubernetes schedules them |

### üéØ **Common Use Cases:**
- **Single Container Pod**: Most common - one app per pod
- **Multi-Container Pod**: Main app + helper (logging, proxy, monitoring)
- **Init Containers**: Setup containers that run before main app starts

### üìã **Your hello-world-carlo Pods:**
When you saw 2 pods running, each one contains:
- Your hello-world application container
- Shared network (each pod has unique IP: 10.244.0.59, 10.244.0.65)
- Running on the same minikube node
- Managed by the hello-world-carlo deployment

**Remember**: You typically don't create pods directly - you use Deployments, which create and manage pods for you!

## [ ] kubectl create, kubectl run, kubectl expose, kubectl set, kubectl get pods, kubectl describe pod, kubectl delete pod

### kubectl create
```bash
# Create pod from YAML file
kubectl create -f pod.yaml

# Create pod from YAML content (inline)
cat << EOF | kubectl create -f -
apiVersion: v1
kind: Pod
metadata:
  name: nginx-pod
spec:
  containers:
  - name: nginx
    image: nginx:latest
    ports:
    - containerPort: 80
EOF

# Create multiple resources from directory
kubectl create -f ./manifests/

# Create from URL
kubectl create -f https://example.com/pod.yaml

# Create with dry-run (test without creating)
kubectl create -f pod.yaml --dry-run=client

# Create and save to YAML file
kubectl create -f pod.yaml --dry-run=client -o yaml > new-pod.yaml
```

### kubectl run
```bash
# Run a simple pod with nginx
kubectl run nginx-pod --image=nginx:latest

# Run pod with specific port
kubectl run web-app --image=nginx --port=80

# Run pod with environment variables
kubectl run app --image=busybox --env="ENV=production" --env="DEBUG=false"

# Run pod with labels
kubectl run labeled-pod --image=nginx --labels="app=web,tier=frontend"

# Run pod with resource limits
kubectl run limited-pod --image=nginx --requests="cpu=100m,memory=128Mi" --limits="cpu=200m,memory=256Mi"

# Run pod with command
kubectl run busybox-pod --image=busybox -- /bin/sh -c "sleep 3600"

# Run pod and expose it as service
kubectl run web --image=nginx --port=80 --expose

# Run pod in specific namespace
kubectl run test-pod --image=nginx -n testing

# Run pod with restart policy
kubectl run one-time --image=busybox --restart=Never -- echo "Hello World"

# Generate YAML without creating
kubectl run nginx --image=nginx --dry-run=client -o yaml
```

### kubectl expose
```bash
# Expose pod as ClusterIP service (default)
kubectl expose pod nginx-pod --port=80 --target-port=80

# Expose pod as NodePort service
kubectl expose pod nginx-pod --type=NodePort --port=80

# Expose pod as LoadBalancer service
kubectl expose pod nginx-pod --type=LoadBalancer --port=80

# Expose deployment as service
kubectl expose deployment nginx-deployment --port=80 --target-port=80

# Expose with specific service name
kubectl expose pod nginx-pod --port=80 --name=nginx-service

# Expose with custom selector
kubectl expose pod nginx-pod --port=80 --selector="app=nginx"

# Expose multiple ports
kubectl expose pod multi-port --port=80,443 --target-port=8080,8443

# Generate service YAML without creating
kubectl expose pod nginx-pod --port=80 --dry-run=client -o yaml
```

### kubectl set
```bash
# Set/update container image
kubectl set image pod/nginx-pod nginx=nginx:1.21

# Set image for deployment
kubectl set image deployment/nginx-deployment nginx=nginx:1.21

# Set environment variables
kubectl set env pod/nginx-pod ENV=production DEBUG=false

# Set resource requests/limits
kubectl set resources pod/nginx-pod --requests=cpu=100m,memory=128Mi --limits=cpu=200m,memory=256Mi

# Set service account
kubectl set serviceaccount pod/nginx-pod my-service-account

# Set subject for role binding
kubectl set subject clusterrolebinding admin --serviceaccount=default:myapp

# Update image with record (for rollback)
kubectl set image pod/nginx-pod nginx=nginx:1.21 --record

# Set selector for service
kubectl set selector service/nginx-service app=nginx,version=v1
```

### kubectl get pods
```bash
# Get all pods in current namespace
kubectl get pods

# Get pods with more details
kubectl get pods -o wide

# Get pods from all namespaces
kubectl get pods --all-namespaces
kubectl get pods -A  # Short form

# Get pods with specific labels
kubectl get pods -l app=myapp

# Get pods with custom output formats
kubectl get pods -o yaml
kubectl get pods -o json

# Watch pods in real-time
kubectl get pods -w

# Filter pods by status
kubectl get pods --field-selector=status.phase=Running
kubectl get pods --field-selector=status.phase=Pending
```

### kubectl describe pod
```bash
# Get detailed information about a pod
kubectl describe pod <pod-name>

# Describe pod in specific namespace
kubectl describe pod <pod-name> -n <namespace>

# Example with actual pod name
kubectl describe pod nginx-pod

# What kubectl describe shows:
# - Pod metadata (name, namespace, labels)
# - Pod status and conditions
# - Container information and states
# - Events and troubleshooting info
# - Resource requests/limits
# - Volume mounts and secrets
# - Network information (IP, node)
# - QoS class and tolerations
```

### kubectl delete pod
```bash
# Delete a specific pod
kubectl delete pod <pod-name>

# Delete pod in specific namespace
kubectl delete pod <pod-name> -n <namespace>

# Delete multiple pods
kubectl delete pod pod1 pod2 pod3

# Delete all pods with a label
kubectl delete pods -l app=myapp

# Delete using YAML file
kubectl delete -f pod.yaml

# Force delete (use with caution)
kubectl delete pod <pod-name> --force --grace-period=0

# Delete with custom grace period
kubectl delete pod <pod-name> --grace-period=30

# Delete and wait for completion
kubectl delete pod <pod-name> --wait=true
```

## Common Pod Statuses

| Status | Description | Action |
|--------|-------------|---------|
| Pending | Pod accepted but not scheduled | Check node resources, constraints |
| Running | Pod is running on a node | Normal operation |
| Succeeded | All containers terminated successfully | Completed job/task |
| Failed | At least one container failed | Check logs, resource limits |
| Unknown | Pod state cannot be determined | Check node connectivity |
| CrashLoopBackOff | Container keeps failing and restarting | Check logs, fix application |
| ImagePullBackOff | Cannot pull the container image | Verify image name, registry access |

## Quick Reference Examples

```bash
# Basic workflow
kubectl get pods                    # List all pods
kubectl describe pod <name>         # Get pod details
kubectl delete pod <name>           # Delete pod

# Troubleshooting workflow
kubectl get pods                    # Check status
kubectl describe pod <problem-pod>  # Get detailed info
kubectl delete pod <problem-pod>    # Remove if needed
```